---
phase: 03-review
plan: 01
type: execute
wave: 1
depends_on: []
files_modified: [src/netbox_auto/web/__init__.py, src/netbox_auto/web/app.py, src/netbox_auto/web/templates/base.html, src/netbox_auto/web/templates/hosts.html, src/netbox_auto/web/static/style.css, pyproject.toml]
autonomous: true

must_haves:
  truths:
    - "Flask app initializes with database access"
    - "Hosts page displays all discovered hosts in a table"
    - "Table shows MAC, hostname, IPs, status, type, switch port"
  artifacts:
    - path: "src/netbox_auto/web/app.py"
      provides: "Flask application factory"
      exports: [create_app]
    - path: "src/netbox_auto/web/templates/hosts.html"
      provides: "Host list table template"
      contains: "{% for host in hosts %}"
  key_links:
    - from: "web/app.py"
      to: "database.get_session"
      via: "query hosts from DB"
      pattern: "get_session"
    - from: "hosts.html"
      to: "Host model fields"
      via: "template variables"
---

<objective>
Create Flask web application foundation and host list view.

Purpose: Provide visual interface for reviewing discovered hosts before pushing to NetBox.
Output: Working Flask app with host table at /hosts endpoint.
</objective>

<execution_context>
@~/.claude/get-shit-done/workflows/execute-plan.md
@~/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md

@src/netbox_auto/models.py
@src/netbox_auto/database.py
@src/netbox_auto/config.py
</context>

<tasks>

<task type="auto">
  <name>Task 1: Create Flask application</name>
  <files>src/netbox_auto/web/__init__.py, src/netbox_auto/web/app.py, pyproject.toml</files>
  <action>
    1. Add flask>=3.0 to pyproject.toml dependencies
    2. Create web package with __init__.py
    3. Create app.py with create_app() factory:
       - Configure Flask with templates_folder and static_folder
       - Register blueprint for routes
       - Add context processor for db session access
    4. Create routes: / redirects to /hosts, /hosts lists all hosts from DB
    5. Query hosts ordered by last_seen desc
  </action>
  <verify>python -c "from netbox_auto.web.app import create_app; app = create_app()"</verify>
  <done>Flask app factory works, routes defined</done>
</task>

<task type="auto">
  <name>Task 2: Create host list template</name>
  <files>src/netbox_auto/web/templates/base.html, src/netbox_auto/web/templates/hosts.html, src/netbox_auto/web/static/style.css</files>
  <action>
    1. Create base.html with HTML5 structure, CSS link, nav header
    2. Create hosts.html extending base:
       - Table with columns: MAC, Hostname, IPs, Source, Switch Port, Status, Type
       - Each row shows host data
       - Status/type shown as badges
       - IPs shown as comma-separated list (host.ip_addresses is JSON list)
    3. Create minimal style.css:
       - Clean table styling with borders
       - Status badges (pending=yellow, approved=green, rejected=red, pushed=blue)
       - Type badges (different colors)
       - Responsive basics
  </action>
  <verify>ls src/netbox_auto/web/templates/*.html && ls src/netbox_auto/web/static/style.css</verify>
  <done>Templates render hosts in readable table</done>
</task>

</tasks>

<verification>
Before declaring plan complete:
- [ ] Flask app imports without error
- [ ] Templates exist and are valid Jinja2
- [ ] Static CSS file exists
</verification>

<success_criteria>

- Flask app factory creates working application
- /hosts route queries and displays hosts
- Templates render host data in table format
- CSS provides basic styling
</success_criteria>

<output>
After completion, create `.planning/phases/03-review/03-01-SUMMARY.md`
</output>

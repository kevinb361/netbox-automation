---
phase: 03-review
plan: 02
type: execute
wave: 2
depends_on: ["03-01"]
files_modified: [src/netbox_auto/web/app.py, src/netbox_auto/web/templates/hosts.html, src/netbox_auto/web/static/style.css]
autonomous: true

must_haves:
  truths:
    - "User can approve a single host via button click"
    - "User can reject a single host via button click"
    - "User can change host type via dropdown"
    - "User can bulk approve/reject multiple hosts"
    - "Status/type changes persist to database"
  artifacts:
    - path: "src/netbox_auto/web/app.py"
      provides: "Host action endpoints"
      contains: "def update_host"
  key_links:
    - from: "hosts.html"
      to: "POST /hosts/<id>/status"
      via: "form submit"
      pattern: "action=.*status"
    - from: "app.py POST"
      to: "database session"
      via: "commit status change"
      pattern: "session.commit"
---

<objective>
Add host approval, rejection, classification, and bulk actions.

Purpose: Enable user to review and manage discovered hosts for NetBox push.
Output: Working approve/reject/classify buttons and bulk action form.
</objective>

<execution_context>
@~/.claude/get-shit-done/workflows/execute-plan.md
@~/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/03-review/03-01-SUMMARY.md

@src/netbox_auto/models.py
@src/netbox_auto/web/app.py
</context>

<tasks>

<task type="auto">
  <name>Task 1: Add individual host actions</name>
  <files>src/netbox_auto/web/app.py, src/netbox_auto/web/templates/hosts.html</files>
  <action>
    1. Add POST route /hosts/<id>/status to update host status (approve/reject)
    2. Add POST route /hosts/<id>/type to update host type classification
    3. Update hosts.html table rows with action buttons:
       - Approve button (sets status=approved)
       - Reject button (sets status=rejected)
       - Type dropdown (server/workstation/iot/network)
    4. Use simple HTML forms (no JS required) that POST and redirect back
    5. Flash messages for success/error feedback
  </action>
  <verify>Run Flask dev server, click approve on a host, verify status updates in DB</verify>
  <done>Individual host approve/reject/classify works</done>
</task>

<task type="auto">
  <name>Task 2: Add bulk actions</name>
  <files>src/netbox_auto/web/app.py, src/netbox_auto/web/templates/hosts.html, src/netbox_auto/web/static/style.css</files>
  <action>
    1. Add checkboxes to each table row for selection
    2. Add bulk action form at top: dropdown (approve/reject) + submit button
    3. Add POST route /hosts/bulk to handle bulk status updates
    4. Wrap table in form, checkboxes named "host_ids" with host.id as value
    5. Add "Select All" checkbox in header row (simple JS onclick)
    6. Update CSS for checkbox styling
  </action>
  <verify>Select multiple hosts, bulk approve, verify all update</verify>
  <done>Bulk approve/reject works for multiple hosts</done>
</task>

</tasks>

<verification>
Before declaring plan complete:
- [ ] Individual approve/reject changes host status in DB
- [ ] Type dropdown changes host_type in DB
- [ ] Bulk selection and action works
- [ ] Flash messages appear for feedback
</verification>

<success_criteria>

- REVW-02: User can approve individual hosts
- REVW-03: User can reject individual hosts
- REVW-04: User can classify hosts by type
- REVW-05: User can bulk approve/reject
- All changes persist to database
</success_criteria>

<output>
After completion, create `.planning/phases/03-review/03-02-SUMMARY.md`
</output>

---
phase: 04-push
plan: 04
type: execute
wave: 1
depends_on: []
files_modified: [src/netbox_auto/cli.py]
autonomous: true

must_haves:
  truths:
    - "netbox-auto status shows host counts by status"
    - "netbox-auto status shows recent discovery runs"
  artifacts:
    - path: "src/netbox_auto/cli.py"
      provides: "status CLI command"
      contains: "def status"
  key_links:
    - from: "status command"
      to: "database queries"
      via: "SQLAlchemy session"
---

<objective>
Implement status command showing discovery and push summary.

Purpose: Quick view of current state - how many hosts discovered, pending, pushed.
Output: CLI status command with formatted output.
</objective>

<execution_context>
@~/.claude/get-shit-done/workflows/execute-plan.md
@~/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md

@src/netbox_auto/cli.py
@src/netbox_auto/models.py
@src/netbox_auto/database.py
</context>

<tasks>

<task type="auto">
  <name>Task 1: Implement status CLI command</name>
  <files>src/netbox_auto/cli.py</files>
  <action>
Replace stub status command with real implementation:

@app.command()
def status() -> None:
    """Show discovery and push status summary."""

Query database for:
- Total hosts count
- Hosts by status (pending, approved, rejected, pushed)
- Hosts by type (server, workstation, iot, network, unknown)
- Last discovery run (timestamp, status, host count)
- Last 5 discovery runs summary

Display with rich:
```
Host Status:
  Pending:  12
  Approved:  5
  Rejected:  3
  Pushed:   42
  ─────────────
  Total:    62

Host Types:
  Server:      15
  Workstation: 20
  IoT:          8
  Network:      5
  Unknown:     14

Recent Discovery:
  Last run: 2026-01-15 14:30 (completed, 8 new hosts)
```

Use console.print with tables or formatted output like discover command.
Handle empty database gracefully: "No hosts discovered yet. Run 'netbox-auto discover' first."
  </action>
  <verify>netbox-auto status 2>&1 | head -5</verify>
  <done>status command shows host counts and discovery info</done>
</task>

</tasks>

<verification>
Before declaring plan complete:
- [ ] status command shows meaningful output
- [ ] Handles empty database gracefully
- [ ] make lint passes
</verification>

<success_criteria>
- status command works
- Shows host counts by status and type
- Shows recent discovery activity
</success_criteria>

<output>
After completion, create `.planning/phases/04-push/04-04-SUMMARY.md`
</output>
